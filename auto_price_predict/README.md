# Предсказание стоимости автомобиля

*Проект был выполнен в рамках обучения в онлайн-школе Яндекс.Практикум на профессию "Специалист по Data Science".*
- Стек: `Python` `Jupyter` `pandas` `sklearn` `CatBoost` `LightGBM` `sklearn.pipeline` `joblib` 

## Описание проекта
Компания "Чётенькое авто", занимающаяся продажей подержанных автомобилей, планирует создать приложение для привлечения новых клиентов. Одной из возможностей приложения будет быстрое определение рыночной стоимости автомобиля, основываясь на технических характеристиках, комплектации и ценах аналогичных автомобилей, собранных в исторических данных. Для этого необходимо разработать модель, которая быстро и точно определяет стоимость автомобиля.

Заказчику важны:

- качество предсказания
- скорость предсказания
- время обучения

## Описание данных

*Для повторения проекта можно например использовать готовый датасет с Kaggle: https://www.kaggle.com/code/iabhishekmaurya/used-car-price-prediction*


- DateCrawled — дата скачивания анкеты из базы
- VehicleType — тип автомобильного кузова
- RegistrationYear — год регистрации автомобиля
- Gearbox — тип коробки передач
- Power — мощность (л. с.)
- Model — модель автомобиля
- Kilometer — пробег (км)
- RegistrationMonth — месяц регистрации автомобиля
- FuelType — тип топлива
- Brand — марка автомобиля
- Repaired — была машина в ремонте или нет
- DateCreated — дата создания анкеты
- NumberOfPictures — количество фотографий автомобиля
- PostalCode — почтовый индекс владельца анкеты (пользователя)
- LastSeen — дата последней активности пользователя
- Price — цена (евро)

## Выводы

В данном исследование мы обучили модели для предсказания стоимости автомобиля. Мы провели предобработку данных, заполнили пропуски, удалили дубликаты, изменили типы данных, удалили выбросы, провели лемматизацию, создали новые признаки. После этого мы обучили несколько моделей, подобрали лучшие параметры с помощью RandomizedSearchCV, а также провели тестирование моделей на тестовой выборке. Были получены следующие результаты:

----------------------------------------------------------------------------------------------------------------------------

| Model                              | RMSE       | Train time, sec | Train rows | Predict time, sec | Valid rows |
|------------------------------------|------------|-----------------|------------|-------------------|------------|
| LinearRegression                   | 2941.2     | **2.12**        | 170891     | 0.05              | 56964      |
| RandomForestRegressor              | 1749.9     | 84.70           | 170891     | 3.20              | 56964      |
| LGBMRegressor (OrdinalEncoder)     | **1662.8** | **2.26**        | 170891     | **0.17**          | 56964      |
| LGBMRegressor (OHE)                | **1657.2** | **3.23**        | 170891     | 0.46              | 56964      |
| CatBoostRegressor (OrdinalEncoder) | 1690.6     | 6.78            | 170891     | **0.03**          | 56964      |
| CatBoostRegressor (OHE)            | 1673.4     | 7.65            | 170891     | **0.09**          | 56964      |

*Железо: Xeon E5 2670 V3 3.1 Hz 12 cores|24 threads; 16Gb ddr4 2133 MHz | Ssd 2000 Mb/s

----------------------------------------------------------------------------------------------------------------------------

Можно наблюдать, что модели CatBoost и LightGBM показывают почти одинаково хороший результат (меньше 2500). Модель LGBMRegressor обучается быстрее, чем модель CatBoostRegressor, но модель CatBoostRegressor предсказывает быстрее (почти моментально). Также, мы можем сказать, что модели работают сильно лучше, чем DummyRegressor, который показал RMSE: 4561.32 на тестовой выборке.

**LGBMRegressor показал RMSE на тестовой выборке: 1655.67, что меньше, чем требуемый RMSE: 2500. 
Помимо этого, для нас важны показатели - время предсказания и время обучения. 
Время обучения и предсказания у LightGBM меньше, чем у модели CatBoostRegressor, а время предсказания остается невысоким при выборке 
метода OrdinalEncoder для кодирования категориальных признаков. 
При этом RMSE у модели LGBMRegressor также меньше, чем у модели CatBoostRegressor. 
Поэтому, мы можем сказать, что модель LGBMRegressor является наилучшей моделью для предсказания стоимости автомобиля, на наших данных.**

## Инструкция по использованию проекта
Данный проект размещен на Github и выполнен в виде Jupyter Notebook. Для его использования потребуется установленный на компьютере Python и Jupyter Notebook. Так же, для корректной работы, необходимо установить следующие библиотеки:
- `pandas` `numpy` `matplotlib` `scikit-learn` `CatBoost` `joblib` `LightGBM`

## Клонирование репозитория

1. На странице репозитория нажмите кнопку "Code" и выберите способ клонирования.
2. Скопируйте ссылку.
3. Откройте терминал на вашем компьютере.
4. Выберите директорию, куда вы хотите скопировать проект, используя команду `cd <название дериктории>`.
5. Клонируйте репозиторий на свой компьютер, используя команду git clone и вставив скопированную ссылку:
```
git clone https://github.com/KirillFazi/Portfolio.git
```

## Запуск проекта

1. Откройте терминал на вашем компьютере.
2. Выберите директорию, куда вы скопировали проект, используя команду `cd <название дериктории>`.
3. Запустите Jupyter Notebook, используя команду `jupyter notebook`.
4. В открывшемся окне браузера выберите файл `<название_проекта>.ipynb`.

*Note: Для корректной работы проекта требуется использовать готовый датасет. Так как, я не могу предоставить данные, которые использовал в проекте, в связи с политикой Яндекс.Практикума.*
