# Предсказание стоимости автомобиля

*Проект был выполнен в рамках обучения в онлайн-школе Яндекс.Практикум на профессию "Специалист по Data Science".*
- Используемые библиотеки: `pandas` `seaborn` `matplotlib` `statsmodels` `Sklearn`

## Описание проекта

Нужно решить, где бурить новую скважину для добывающей компании «ТатШелГазНефть».

Для определения региона, в котором добыча нефти принесет максимальную прибыль, необходимо построить модель машинного обучения, используя пробы нефти из трех регионов, где были измерены качество нефти и объем ее запасов на 10 000 месторождениях в каждом регионе. Важно также провести анализ возможных рисков и прибыли, используя метод **Bootstrap**.

Как определяют локации:

- В избранном регионе ищут месторождения, для каждого определяют значения признаков
- Строят модель и оценивают объём запасов
- Выбирают месторождения с самым высокими оценками значений. Количество месторождений зависит от бюджета компании и стоимости разработки одной скважины
- Прибыль равна суммарной прибыли отобранных месторождений

## Выводы



### Сравнение моделей, на основе полученных данных из 3 регионов

Для каждого региона были получены требуемые значения 95% доверительный интервал, среднее значение прибыли, и риск понести убытки. Было обучено и протестировано две модели: линейная регрессия и градиентный бустинг.
На основание модели линейной регрессии можно сделать следующий вывод:
**Лучший регион для размещения новых скважен - второй (`geo_data_1`), на основание модели Линейной регрессии**
Обоснование:
- Второй регион, единственный, показал хороший уровень риска (ниже 2.5%). Риск понести убытки равен - 1.1%.
- У этого региона, самая высокая средняя прибыль - 445 (млн. рублей)
- Единственный показатель, по которому данный регион можно считать менее предпочтительным, это максимальная возможная прибыль в 95% доверительном интервале. В первом и третьем регионе этот показатель в пределах 950 (млн. рублей). Во втором он равен 837 (млн. рублей).
- Последний факт в пользу второго региона это безубыточный 95% доверительный интервал. Минимальная возможная прибыль равна 57 (млн. рублей). В остальных регионах в интервал входят отрицательный значения (убытки).

На основание модели градиентного бустинга можно сделать следующий вывод:

Максимальный шанс понести убытки равен 1.9% (в первом регионе). То есть, в любом регионе можно размещать скважины, при учете порогового значения 2.5%. Но среди всех регионов, один является наиболее предпочтительным.
**Лучший регион для размещения новых скважен - третий (`geo_data_2`), на основание модели Градиентного бустинга**

- Третий регион, единственный, показал уровень риска ниже 1%. Риск понести убытки равен - 0.4%.
- У этого региона, самая высокая возможная средняя прибыль - 737 (млн. рублей)
- Также, у данного региона наибольшая максимальная возможная прибыль в 95% доверительном интервале. В нем она равна 1 280 (млн. рублей). В первом и во втором регионе этот показатель в пределах 837 - 1 013 (млн. рублей).
- У третьего региона безубыточный 95% доверительный интервал. Минимальная возможная прибыль равна 213 (млн. рублей). В остальных регионах значения не превышают 57 млн. рублей.

### Вывод по моделям

В техническом задании было четко указанно использование линейной регрессии для анализа. Полученные результаты от нее можно использовать для предсказания и выбирать регионы, но более предпочтительным вариантом для анализа в данной ситуации является модель градиентного бустинга. Она показывает более высокую точность, с большим успехом находится зависимость в нелинейных данных. Линейная регрессия показала себя хорошо только на очень сомнительном дата сете, который нуждается в перепроверки. В остальных же регионах она показала уровень риска выше 2.5%. Это может говорить о том, что модель сможет корректно работать только с данным, в которых есть очень сильная линейная зависимость с высоким коэффициентом корреляции.
**Я рекомендую, сделать выбор в пользу модели Градиентного бустинга и использовать ее для анализа регионов для добычи.**

### Примечание по данным

В ходе исследования были обнаружены следующие моменты, на который стоит обратить внимание:

- Было обнаружено 36 дубликатов (повторяющиеся значения) в колонке `id` (всего 18 `id`). Данные дубликаты имеют отличные друг от друга показатели `f0` `f1` `f2` и `product`. Отличаются они сильно и отличия в колонке `product` могут быть более 100 тыс. баррелей.
- В данных из региона 2 (`geo_data_1`) было обнаружено не естественное распределение данных в колонках `f2` и `product`:
    + Колонки `f2` и `product` имеют коэффициент корреляции равный 1. То есть, кол-во нефти в скважине напрямую (на 100%) зависит от параметра `f2`. Стоит убедиться в корректности полученных измерений.
    + Распределение в колонке `product` похоже на столбчатую диаграмму с 12 выбросами. То есть, на все 10 000 скважен мы имеем только 12 уникальных значение. Как будто, кто-то округлил все полученные баррели до 12 определенных значений. По такому же принципу распределены значения в колонке `f2`. Вероятность получить такие данные в реальности стремится к нулю. **Стоит обеспокоиться этим вопросом и проверить при каких условиях и каким образом был проведен сбор данных для датасета `geo_data_1`.**




## Инструкция по использованию проекта
Данный проект размещен на Github и выполнен в виде Jupyter Notebook. Для его использования потребуется установленный на компьютере Python и Jupyter Notebook. Так же, для корректной работы, необходимо установить следующие библиотеки:
- `pandas` `matplotlib` `seaborn` `scikit-learn` `statsmodels`

## Клонирование репозитория

1. На странице репозитория нажмите кнопку "Code" и выберите способ клонирования.
2. Скопируйте ссылку.
3. Откройте терминал на вашем компьютере.
4. Выберите директорию, куда вы хотите скопировать проект, используя команду `cd <название дериктории>`.
5. Клонируйте репозиторий на свой компьютер, используя команду git clone и вставив скопированную ссылку:
```
git clone https://github.com/KirillFazi/Portfolio.git
```

## Запуск проекта

1. Откройте терминал на вашем компьютере.
2. Выберите директорию, куда вы скопировали проект, используя команду `cd <название дериктории>`.
3. Запустите Jupyter Notebook, используя команду `jupyter notebook`.
4. В открывшемся окне браузера выберите файл `<название_проекта>.ipynb`.

*Note: Для корректной работы проекта требуется использовать готовый датасет. Так как, я не могу предоставить данные, которые использовал в проекте, в связи с политикой Яндекс.Практикума.*
